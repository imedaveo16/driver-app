# ุชุทุจูู ุณุงุฆู ุงูุญูุงูุฉ ุงููุฏููุฉ - ุฏููู ุงูุงุณุชุฎุฏุงู

## ูุธุฑุฉ ุนุงูุฉ

ุชู ุจูุงุก ุชุทุจูู "ุณุงุฆู ุงูุญูุงูุฉ ุงููุฏููุฉ" ููุงุฌูุฉ ููุจ ูุชูุงููุฉ ูููุญุฏุงุช ุงูููุฏุงููุฉุ ูุชุตู ุจูุธุงู Firebase Firestore ูุงุณุชูุจุงู ุงูููุงู ูุชุญุฏูุซ ุงูุญุงูุงุช ูู ุงูููุช ุงูุญูููู.

## ุงูููุฒุงุช ุงูุฑุฆูุณูุฉ

### โ 1. ุงุณุชูุจุงู ุงูููุงู (Mission Dispatch)
- ุงุณุชูุงุน ุฏุงุฆู ููุฌููุนุฉ `reports` ูู Firebase Firestore
- ุชูุจููุงุช ุฏุงุฎู ุงูุชุทุจูู (In-App Alerts) ููููุงู ุงูุฌุฏูุฏุฉ
- ุนุฑุถ ุชูุงุตูู ุงููููุฉ: ุงูููุนุ ุงูุฃููููุฉุ ุงููุตูุ ุงููููุนุ ุงููุจูุบ

### โ 2. ุงูููุงุญุฉ ุงูุฐููุฉ (Smart Navigation)
- ุฎุฑูุทุฉ ุชูุงุนููุฉ ุจูุถุน Dark Mode ุจุงุณุชุฎุฏุงู Leaflet
- ุนุฑุถ ูููุน ุงูุญุงุฏุซ ุจุฎุฑูุทุฉ ุฏุงุฎููุฉ ูุน markers ูุฎุตุตุฉ
- ุฒุฑ ุนุงุฆู ููุชุญ Google Maps ุงูุฎุงุฑุฌู ูุน ุฑุณู ูุณุงุฑ ูุจุงุดุฑ

### โ 3. ุชุญุฏูุซ ุงูุญุงูุฉ ุงููุญุธู (Status Tracking)
- ุดุฑูุท ุชูุฏู ูุนุฑุถ ูุฑุงุญู ุงูุชุฏุฎู:
  1. ูุจูู ุงููููุฉ (ACCEPTED)
  2. ูู ุงูุทุฑูู (EN_ROUTE)
  3. ูุตู ุฅูู ุงููููุน (ARRIVED)
  4. ุงูุนูุฏุฉ ูููุฑูุฒ (RETURNING)
  5. ุงูุชููุช ุงููููุฉ (COMPLETED)
- ุชุญุฏูุซ ููุฑู ูุญุงูุฉ ุงูุจูุงุบ ูู Firestore

### โ 4. ุชุชุจุน ุงููููุน ุงูุญู (Driver Live Location)
- ุงุณุชุฎุฏุงู Geolocation API ูุชุชุจุน ูููุน ุงูุณุงุฆู
- ุชุญุฏูุซ ูููุน ุงูุณุงุฆู ูู 5 ุซูุงูู ูู Firestore
- ุญุณุงุจ ุงููุณุงูุฉ ุงููุชุจููุฉ ูููุตูู ูููููุน
- ุนุฑุถ ุงููุณุงูุฉ ูุจุงุดุฑุฉ ุนูู ูุงุฌูุฉ ุงูุณุงุฆู

### โ 5. ูุงุฌูุฉ ูุณุชุฎุฏู ุนุงููุฉ ุงูุชุจุงูู (High-Contrast UI)
- ุชุตููู ูุธูู (Dark Mode) ููุงุณุจ ููููุงุฏุฉ ุงูููููุฉ
- ุฃููุงู ุนุงููุฉ ุงูุชุจุงูู (Orange & Red) ุนูู ุฎูููุฉ ุณูุฏุงุก
- ุนูุงุตุฑ ูุจูุฑุฉ ููุงุถุญุฉ ูุณูููุฉ ุงูุงุณุชุฎุฏุงู ุฃุซูุงุก ุงูููุงุฏุฉ
- ุชุตููู ูุชุฌุงูุจ ูุนูู ุนูู ุงูุฃุฌูุฒุฉ ุงููุญูููุฉ

## ุงูุจููุฉ ุงูุชูููุฉ

### ุงูุชูููุงุช ุงููุณุชุฎุฏูุฉ
- **Framework**: Next.js 15 with App Router
- **Language**: TypeScript 5
- **Styling**: Tailwind CSS 4 + shadcn/ui
- **Database**: Firebase Firestore (Real-time Database)
- **Maps**: Leaflet.js (Dark Mode) + Google Maps Integration
- **Location**: Browser Geolocation API

### ูููู ุงููุดุฑูุน

```
src/
โโโ app/
โ   โโโ page.tsx                    # ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ (ุงุฎุชูุงุฑ ุงูุชุทุจูู)
โ   โโโ driver/
โ   โ   โโโ page.tsx                # ููุญุฉ ุชุญูู ุงูุณุงุฆู ุงูุฑุฆูุณูุฉ
โ   โ   โโโ login/
โ   โ       โโโ page.tsx            # ุตูุญุฉ ุชุณุฌูู ุงูุฏุฎูู
โ   โโโ globals.css                 # ุงูุชูุณููุงุช ุงูุนุงูุฉ
โโโ components/
โ   โโโ driver/
โ   โ   โโโ mission-map.tsx         # ูููู ุงูุฎุฑูุทุฉ ุงูุชูุงุนููุฉ
โ   โ   โโโ mission-alert.tsx       # ุชูุจูู ุงููููุฉ ุงูุฌุฏูุฏุฉ
โ   โ   โโโ mission-status-tracker.tsx  # ุดุฑูุท ุชุชุจุน ุงูุญุงูุฉ
โ   โโโ ui/                         # ููููุงุช shadcn/ui
โโโ hooks/
โ   โโโ use-driver-location.ts      # Hook ูุชุชุจุน ูููุน ุงูุณุงุฆู
โ   โโโ use-toast.ts                # Hook ููุฅุดุนุงุฑุงุช
โโโ lib/
    โโโ firebase/
    โ   โโโ config.ts               # ุฅุนุฏุงุฏุงุช Firebase
    โ   โโโ firestore.ts            # ุฏูุงู Firestore
    โโโ utils.ts                    # ุฏูุงู ูุณุงุนุฏุฉ
```

## ุฅุนุฏุงุฏ Firebase

### 1. ุฅูุดุงุก ูุดุฑูุน Firebase

1. ุงุฐูุจ ุฅูู [Firebase Console](https://console.firebase.google.com/)
2. ุฃูุดุฆ ูุดุฑูุน ุฌุฏูุฏ ุฃู ุงุฎุชุฑ ูุดุฑูุนุงู ููุฌูุฏุงู
3. ูุนู Firestore Database
4. ุฃูุดุฆ ุงููุฌููุนุงุช ุงูุชุงููุฉ:
   - `reports` - ููููุงู ูุงูุจูุงุบุงุช
   - `drivers` - ููุณุงุฆููู
   - `vehicles` - ูููุฑูุจุงุช
   - `units` - ูููุญุฏุงุช

### 2. ุฅุนุฏุงุฏ ูุชุบูุฑุงุช ุงูุจูุฆุฉ

ุฃูุดุฆ ููู `.env.local` ูู ุฌุฐุฑ ุงููุดุฑูุน:

```env
NEXT_PUBLIC_FIREBASE_API_KEY=your_api_key
NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN=your_project.firebaseapp.com
NEXT_PUBLIC_FIREBASE_PROJECT_ID=your_project_id
NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET=your_project.appspot.com
NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID=your_sender_id
NEXT_PUBLIC_FIREBASE_APP_ID=your_app_id
```

### 3. ูููู ุจูุงูุงุช Firestore

#### ูุซููุฉ ุงูุจูุงุบ (Report/Document)

```json
{
  "id": "mission_123",
  "type": "emergency",
  "priority": "high",
  "description": "ุญุงุฏุซ ูุฑูุฑู ูู ุงูุดุงุฑุน ุงูุฑุฆูุณู",
  "location": {
    "lat": 36.7538,
    "lng": 3.0588,
    "address": "ุดุงุฑุน ุงูุงุณุชููุงูุ ุงูุฌุฒุงุฆุฑ ุงูุนุงุตูุฉ"
  },
  "status": "pending",
  "assignedDriverId": "driver_456",
  "assignedVehicleId": "ambulance_789",
  "createdAt": "2024-01-15T10:30:00Z",
  "updatedAt": "2024-01-15T10:30:00Z",
  "reporterName": "ูุญูุฏ ุฃุญูุฏ",
  "reporterPhone": "0555123456"
}
```

#### ุฃููุงุน ุงูุญุงูุฉ (Mission Status)
- `pending` - ูู ุงูุงูุชุธุงุฑ
- `accepted` - ุชู ุงููุจูู
- `en_route` - ูู ุงูุทุฑูู
- `arrived` - ูุตู ูููููุน
- `returning` - ุนูุฏุฉ ูููุฑูุฒ
- `completed` - ุงูุชููุช ุงููููุฉ

#### ุฃููุงุน ุงููููุงุช (Mission Type)
- `emergency` - ุทูุงุฑุฆ
- `medical` - ุทุจู
- `fire` - ุญุฑูู
- `rescue` - ุฅููุงุฐ
- `other` - ุขุฎุฑ

## ููููุฉ ุงูุงุณุชุฎุฏุงู

### 1. ุงูุฏุฎูู ููุชุทุจูู

1. ุงูุชุญ ุงููุชุตูุญ ูุงุฐูุจ ุฅูู `http://localhost:3000`
2. ุงุฎุชุฑ "ุชุทุจูู ุงูุณุงุฆู"
3. ุฃุฏุฎู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ูุฑูู ุชุนุฑูู ุงูุณุงุฆู
4. ุณูุชู ุญูุธ ุงูุจูุงูุงุช ูู localStorage ููุงุณุชุฎุฏุงู ุงููุณุชูุจูู

### 2. ุงุณุชูุจุงู ุงูููุงู

ุนูุฏูุง ุชุฑุณู ููุตุฉ ุงูุชุญูู (C.C.O) ูููุฉ ุฌุฏูุฏุฉ:
- ูุธูุฑ ุชูุจูู ููุจุซู ุชููุงุฆูุงู ูุน ุชูุงุตูู ุงููููุฉ
- ุนุฏุงุฏ ุชูุงุฒูู ููุฏุฉ 30 ุซุงููุฉ ูููุจูู ุฃู ุงูุฑูุถ
- ุตูุช ุชูุจูู (ุงุฎุชูุงุฑู) ุนูุฏ ูุตูู ูููุฉ ุฌุฏูุฏุฉ

### 3. ูุจูู ุงููููุฉ

1. ุงุถุบุท ุนูู ุฒุฑ "ูุจูู ุงููููุฉ" ูู ุงูุชูุจูู
2. ุณุชุชุบูุฑ ุญุงูุฉ ุงููููุฉ ุฅูู "ACCEPTED"
3. ุณุชูุธูุฑ ุงูุฎุฑูุทุฉ ูููุน ุงูุญุงุฏุซ ููููุนู ุงูุญุงูู
4. ุณูุจุฏุฃ ุชุชุจุน ูููุนู ุชููุงุฆูุงู

### 4. ุงูุชููู ูููููุน

**ุงูุฎูุงุฑ 1: ุงุณุชุฎุฏุงู ุงูุฎุฑูุทุฉ ุงูุฏุงุฎููุฉ**
- ุงุณุชุนุฑุถ ุงูุฎุฑูุทุฉ ุงูุชูุงุนููุฉ ูุฑุคูุฉ ุงููููุน
- ุงููุณุงูุฉ ุงููุชุจููุฉ ุชูุนุฑุถ ุนูู ุงูุดุงุดุฉ

**ุงูุฎูุงุฑ 2: ุงุณุชุฎุฏุงู Google Maps**
- ุงุถุบุท ุฒุฑ "Google Maps"
- ุณููุชุญ ุชุทุจูู Google Maps ูุน ุงููุณุงุฑ ุงููุฑุณู
- ููููู ุงููุชุงุจุนุฉ ุฃุซูุงุก ุงูููุงุฏุฉ

### 5. ุชุญุฏูุซ ุญุงูุฉ ุงููููุฉ

ุงุณุชุฎุฏู ุดุฑูุท ุงูุชูุฏู ูุชุญุฏูุซ ุงูุญุงูุฉ:

1. **ูุจูู ุงููููุฉ** โ - ุนูุฏ ุงุณุชูุงู ุงููููุฉ
2. **ูู ุงูุทุฑูู** ๐ - ุนูุฏ ุจุฏุก ุงูุชุญุฑู
3. **ูุตู ูููููุน** ๐ - ุนูุฏ ุงููุตูู ูููุงู ุงูุญุงุฏุซ
4. **ุงูุนูุฏุฉ ูููุฑูุฒ** โฉ๏ธ - ุนูุฏ ุฅููุงุก ุงููููุฉ
5. **ุงูุชููุช** โ - ุนูุฏ ุงููุตูู ูููุฑูุฒ

### 6. ุงูุชุชุจุน ุงูุญู

- ูููุนู ููุญุฏูุซ ูู 5 ุซูุงูู ูู Firestore
- ูููู ูููุตุฉ ุงูุชุญูู ุฑุคูุชู ุนูู ุงูุฎุฑูุทุฉ
- ุงููุณุงูุฉ ุงููุชุจููุฉ ุชูุญุฏุซ ุชููุงุฆูุงู
- ุญุงูุฉ ุงูุงุชุตุงู ุชูุนุฑุถ ูู ุงูุฑุฃุณ ุงูุนููู

## ุงูุชูุงูู ูุน ููุตุฉ ุงูุชุญูู (C.C.O)

### ููู ุชุฑุณู ุงููููุงุช ูู ุงูููุตุฉ

ุนูุฏ ุฅูุดุงุก ูููุฉ ุฌุฏูุฏุฉ ูู ููุตุฉ ุงูุชุญูู:

```javascript
// ูุซุงู ูู ููุตุฉ ุงูุชุญูู
await setDoc(doc(db, 'reports', missionId), {
  type: 'emergency',
  priority: 'high',
  description: 'ุญุงุฏุซ ูุฑูุฑู ุทุงุฑุฆ',
  location: {
    lat: 36.7538,
    lng: 3.0588,
    address: 'ุดุงุฑุน ุงูุงุณุชููุงู'
  },
  status: 'pending',
  assignedDriverId: 'driver_123', // ID ุงูุณุงุฆู
  assignedVehicleId: 'ambulance_456',
  createdAt: new Date(),
  updatedAt: new Date(),
});
```

### ููู ุชุฑุงูุจ ุงูุณุงุฆููู

```javascript
// ุงุณุชูุงุน ูุชุญุฏูุซุงุช ูููุน ุงูุณุงุฆู
onSnapshot(doc(db, 'drivers', driverId), (doc) => {
  const data = doc.data();
  console.log('Driver location:', data.currentLocation);
  console.log('Last update:', data.lastLocationUpdate);
});
```

## ุงูุฃูุงู ูุงูุฃุฐููุงุช

### ุฅุนุฏุงุฏุงุช ุฃูุงู Firestore

```javascript
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    match /reports/{reportId} {
      allow read: if request.auth != null;
      allow write: if request.auth != null;
    }

    match /drivers/{driverId} {
      allow read: if request.auth != null;
      allow write: if request.auth.uid == driverId;
    }
  }
}
```

## ุงูุชุญููู ูุชุทุจูู ููุจุงูู (APK)

### ุฎูุงุฑ 1: Capacitor (ููุตู ุจู)

Capacitor ูุญูู ุชุทุจูู ุงูููุจ ุฅูู ุชุทุจูู ุฃุตูู (Native):

```bash
# ุชุซุจูุช Capacitor
npm install @capacitor/core @capacitor/cli @capacitor/android

# ุฅุนุฏุงุฏ ุงูุชุทุจูู
npx cap init CivilProtectionDriver com.civilprotection.driver

# ุจูุงุก ุงูู Android App
npx cap add android
npm run build
npx cap sync android

# ูุชุญ Android Studio
npx cap open android
```

### ุฎูุงุฑ 2: PWA (Progressive Web App)

ุฌุนู ุงูุชุทุจูู ูุนูู ูู PWA ููุชุญููู ุนูู ุงูููุงุชู:

```bash
npm install next-pwa
```

ุซู ุฃุถู ุงูุชูููู ูู `next.config.ts`:

```typescript
import withPWA from 'next-pwa';

export default withPWA({
  dest: 'public',
  register: true,
  skipWaiting: true,
})(/* Next.js config */);
```

## ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ุงููุดููุฉ: ูุง ูุธูุฑ ุงููููุน

**ุงูุญู**:
1. ุชุฃูุฏ ูู ููุญ ุฅุฐู ุงููููุน ูู ุงููุชุตูุญ
2. ุชุญูู ูู ุฅุนุฏุงุฏุงุช GPS ูู ุงููุงุชู
3. ุงุณุชุฎุฏู HTTPS (ูุทููุจ ูู Geolocation)

### ุงููุดููุฉ: ูุง ุชุธูุฑ ุงูููุงู

**ุงูุญู**:
1. ุชุฃูุฏ ูู ุฃู `assignedDriverId` ูู ุงููููุฉ ูุชุทุงุจู ูุน ID ุงูุณุงุฆู
2. ุชุฃูุฏ ูู ุฃู Firestore rules ุชุณูุญ ุจุงููุฑุงุกุฉ
3. ุชุญูู ูู ุงุชุตุงู ุงูุฅูุชุฑูุช

### ุงููุดููุฉ: ุงูุฎุฑูุทุฉ ูุง ุชูุญูู

**ุงูุญู**:
1. ุชุฃูุฏ ูู ุงุชุตุงู ุงูุฅูุชุฑูุช
2. ุชุญูู ูู ุฃู Leaflet CSS ู JS ููุญูููุงู
3. ุชุฃูุฏ ูู ุฃู container ููุฎุฑูุทุฉ ูู ุงุฑุชูุงุน ูุงุถุญ

## ุงูุฏุนู ูุงูุชูุซูู ุงูุฅุถุงูู

- [Next.js Documentation](https://nextjs.org/docs)
- [Firebase Documentation](https://firebase.google.com/docs)
- [Leaflet Documentation](https://leafletjs.com/reference.html)
- [Tailwind CSS Documentation](https://tailwindcss.com/docs)

## ููุงุญุธุงุช ูุงูุฉ

โ๏ธ **ููู**: ูุฐุง ุชุทุจูู ููุจ ูุชูุงูู ูุนูู ุนูู ุงููุชุตูุญ. ูุชุญูููู ุฅูู APKุ ุชุญุชุงุฌ ูุงุณุชุฎุฏุงู Capacitor ุฃู React Native.

โ๏ธ **ููู**: ุชุฃูุฏ ูู ุงุณุชุฎุฏุงู HTTPS ูู ุจูุฆุฉ ุงูุฅูุชุงุฌ ูุชูุนูู Geolocation API.

โ๏ธ **ููู**: ุชูุนูู Push Notifications ุงููุนููุฉ ูุชุทูุจ ุฅุนุฏุงุฏ Firebase Cloud Messaging ูุชุทุจูู ููุจุงูู ุฃุตูู.

---

**ุงูุญูุงูุฉ ุงููุฏููุฉ ุงูุฌุฒุงุฆุฑูุฉ ยฉ 2024**
