#!/bin/sh

##############################################################################
#
#  Gradle start up script for POSIX generated by Gradle.
#
#  Important for running:
#
#  (1) You need a POSIX-compliant shell to run this script. If your /bin/sh is
#    noncompliant, but you have some other compliant shell such as ksh or
#    bash, then to run this script, type that shell name before the whole
#    command line, like:
#
#        ksh Gradle
#
#    Busybox and similar reduced shells will NOT work, because this script
#    requires all of these POSIX shell features:
#  * functions;
#  * expansions «$var», «${var}», «${var:-default}», «${var+SET}»,
#    * command substitution «$(command)»;
#  * compound commands having a testable exit status, especially «case»;
#  * various built-in commands including «command», «set», and «ulimit».
#
#  Important for patching:
#
#  (2) This script targets any POSIX shell, so it avoids extensions provided
#    by Bash, Ksh, etc; in particular arrays are avoided.
#
#    The "traditional" practice of packing multiple parameters into a
#    space-separated string is a well documented source of bugs and security
#    problems, so this is (mostly) avoided, by progressively accumulating
#    options in "$@", and eventually passing that to Java.
#
#    Where the inherited environment variables (DEFAULT_JVM_OPTS, JAVA_OPTS,
#    and GRADLE_OPTS) rely on word-splitting, this is performed explicitly;
#    see the in-line comments for details.
#
#    There are tweaks for specific operating systems such as AIX, CygWin,
#    Darwin, MinGW, and NonStop.
#
#  (3) This script is generated from the Groovy template
#    https://github.com/gradle/gradle/blob/HEAD/subprojects/plugins/src/main/resources/org/gradle/api/internal/plugins/unixStartScript.txt
#    within the Gradle project.
#
#    You can find Gradle at https://github.com/gradle/gradle/.
#
##############################################################################

# Attempt to set APP_HOME

# Resolve links: $0 may be a link
app_path=$0

while [ -h "$app_path" ]; do
  ls=$(ls -ld "$app_path")
  link=$(expr "$ls" : '.*-> \(.*\)$' || echo "$ls")
  if expr "$link" : '/.*' > /dev/null; then
    app_path="$link"
  else
    app_path="$(dirname "$app_path")/$link"
  fi
done

# This is normally unused
# shellcheck disable=SC2034
APP_BASE_NAME=$(basename "$app_path")
# Attempt to set APP_HOME
# shellcheck disable=SC2166
APP_HOME=$(cd "$(dirname "$app_path")/.." && pwd)

# shellcheck disable=SC2166
if [ -z "$APP_HOME" ]; then
    APP_HOME=$(cd / && pwd)
fi

# shellcheck disable=SC2034
APP_NAME=$(basename "$APP_BASE_NAME")

# Use the maximum available, or set MAX_FD != -1 to use that value.
MAX_FD="maximum"

warn () {
    echo "$*"
} >&2

die () {
    warn
    exit 1
} >&2

# OS specific support (must be 'true' or 'false').
cygwin=false
msys=false
darwin=false
nonstop=false
case "$(uname)" in
  CYGWIN*)
    cygwin=true
    ;;
  Darwin*)
    darwin=true
    ;;
  MSYS*|MINGW*)
    msys=true
    ;;
  NONSTOP*)
    nonstop=true
    ;;
esac

CLASSPATH=$APP_HOME/gradle/wrapper/gradle-wrapper.jar


# Determine the Java command to use to start the JVM.
if [ -n "$JAVA_HOME" ] ; then
    if [ -x "$JAVA_HOME/jre/sh/java" ] ; then
        # IBM's JDK on AIX uses strange locations for the executables
        JAVACMD=$JAVA_HOME/jre/sh/java
    else
        JAVACMD=$JAVA_HOME/bin/java
    fi
    if [ ! -x "$JAVACMD" ] ; then
        die "ERROR: JAVA_HOME is set to an invalid directory: $JAVA_HOME

Please set the JAVA_HOME variable in your environment to match the
location of your Java installation."
    fi
else
    JAVACMD=java
    which java >/dev/null 2>&1 || die "ERROR: JAVA_HOME is not set and no 'java' command could be found in your PATH.

Please set the JAVA_HOME variable in your environment to match the
location of your Java installation."
fi

# Increase the maximum file descriptors if we can.
if [ "$cygwin" = "false" -a "$darwin" = "false" -a "$nonstop" = "false" ] ; then
    MAX_FD_LIMIT=$(ulimit -H -n)
    if [ $? -eq 0 ] ; then
        if [ "$MAX_FD" = "maximum" -o "$MAX_FD" = "max" ] ; then
            # shellcheck disable=SC2019
            MAX_FD="$MAX_FD_LIMIT"
        else
            if [ "$MAX_FD_LIMIT" != "unlimited" ] ; then
                MAX_FD=$(min "$MAX_FD_LIMIT" "$MAX_FD")
            fi
        fi
    fi
fi

# For Darwin, add options to specify how the application appears in the dock
if [ "$darwin" = "true" ]; then
    GRADLE_OPTS="$GRADLE_OPTS \"-Xdock:name=$APP_NAME\" \"-Xdock:icon=$APP_HOME/media/gradle.icns\""
fi

# For Cygwin or MSYS, switch paths to Windows format before running java
if [ "$cygwin" = "true" -o "$msys" = "true" ] ; then
    APP_HOME=$(cygpath --path --mixed "$APP_HOME")
    CLASSPATH=$(cygpath --path --mixed "$CLASSPATH")
    JAVACMD=$(cygpath --path --mixed "$JAVACMD")

    # For Cygwin, switch paths to Windows format before running java
    # shellcheck disable=SC2019
    [ -e "$APP_HOME/" ] && APP_HOME=$(cd / && pwd -P)/cygdrive-c/$(cd "$APP_HOME" && pwd -P | cut -d: -f2)
fi

# Escape application args
save () {
    for i do printf %s\\n "$i" | sed "s/'/'\\\\''/g;2d;s/\\([\"\\\`$\\\\]/\\\\\\\\1/g"
}
APP_ARGS=$(save "$@")

# Collect all arguments for the java command, following the shell quoting and substitution rules
eval set -- $DEFAULT_JVM_OPTS $JAVA_OPTS $GRADLE_OPTS "\"-Dorg.gradle.appname=$APP_BASE_NAME\"" -classpath "\"$CLASSPATH\"" org.gradle.wrapper.GradleWrapperMain "$APP_ARGS"

# shellcheck disable=SC2086
exec "$JAVACMD" "$@"
